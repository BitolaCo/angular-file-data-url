angular.module("file-data-url",[]).directive("ngFile",function(){return{require:"?ngModel",restrict:"A",link:function(e,t,a,n){function i(t){e.$$phase?n.$setViewValue(t):e.$apply(function(){n.$setViewValue(t)})}function r(){var e=t[0].files[0]||!1;if(!e)return void i(null);try{o.readAsDataURL(e)}catch(a){}}var o=new FileReader;t.on("change",r),angular.forEach(["ngMaxWidth","ngMaxHeight","ngQuality","ngFormat"],function(e){a.$observe(e,r)}),o.onloadend=function(){var e=a.ngFormat||"image/jpeg",t=new Image;t.src=o.result,t.onload=function(){var n=t.width,r=t.height,o=parseFloat(a.ngQuality||1),g=parseInt(a.ngMaxWidth||t.width),l=parseInt(a.ngMaxHeight||t.height),u=document.createElement("canvas"),c=u.getContext("2d");n>g&&(r*=g/n,n=g),r>l&&(n*=l/r,r=l),u.width=n,u.height=r,c.drawImage(this,0,0,n,r),i(u.toDataURL(e,isNaN(o)?1:o))}}}}});