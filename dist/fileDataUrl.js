angular.module("file-data-url",[]).directive("ngFile",["$log",function(){return{require:"?ngModel",restrict:"A",link:function(e,n,t,a){function i(e){a.$setViewValue(e)}function r(){var e=n[0].files[0]||!1;return e?void g.readAsDataURL(e):void i(null)}var g=new FileReader;n.on("change",r),angular.forEach(["ngMaxWidth","ngMaxHeight","ngQuality","ngFormat"],function(e){t.$observe(e,r)}),g.onloadend=function(){var e=t.ngFormat||"image/jpeg",n=new Image;n.src=g.result,n.onload=function(){var a=n.width,r=n.height,g=t.ngQuality||1,o=parseInt(t.ngMaxWidth||n.width),l=parseInt(t.ngMaxHeight||n.height),u=document.createElement("canvas"),d=u.getContext("2d");a>o&&(r*=o/a,a=o),r>l&&(a*=l/a,r=l),u.width=a,u.height=r,d.drawImage(this,0,0,a,r),i(u.toDataURL(e,g))}}}}}]);