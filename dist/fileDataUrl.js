angular.module("file-data-url",[]).directive("ngFile",function(){return{require:"?ngModel",restrict:"A",link:function(e,t,a,n){var i=new FileReader,r=function(t){e.$apply(function(){n.$setViewValue(t)})};t.on("change",function(){var e=t[0].files[0]||!1;return e?void i.readAsDataURL(e):void r(null)}),i.onloadend=function(){var e=t.data("img-format")||"image/jpeg",a=new Image;a.src=i.result,a.onload=function(){var n=a.width,i=a.height,d=t.data("img-quality")||null,l=parseInt(t.data("max-width")||a.width),o=parseInt(t.data("max-height")||a.height),u=document.createElement("canvas"),g=u.getContext("2d");n>i?n>l&&(i*=l/n,n=l):i>o&&(n*=o/n,i=o),u.width=n,u.height=i,g.drawImage(this,0,0,n,i),r(u.toDataURL(e,d))}}}}});